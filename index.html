<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jurnal 7 Kebiasaan Anak Indonesia Hebat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/sdncakungbarat01/kelas3a.github.io/refs/heads/main/post-image-1756656844769.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .journal-page { 
            background: linear-gradient(135deg, #fef7cd 0%, #fff9e6 100%);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .habit-row { 
            border-bottom: 2px dotted #d1d5db;
            transition: all 0.3s ease;
        }
        .habit-row:hover { background-color: rgba(255,255,255,0.5); }
        .checkbox-custom {
            width: 24px;
            height: 24px;
            border: 2px solid #6b7280;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        .checkbox-custom.checked {
            background-color: #10b981;
            border-color: #10b981;
            position: relative;
        }
        .checkbox-custom.checked::after {
            content: '‚úì';
            color: white;
            font-weight: bold;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
        }
        .reflection-box {
            background: rgba(255,255,255,0.7);
            border: 2px dashed #9ca3af;
            min-height: 120px;
        }
        .date-header {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }
        .print-friendly { 
            background: white !important;
            color: black !important;
        }
        
       /* Perbaikan CSS untuk tombol di tampilan mobile */

/* Enhanced Mobile Styles - Update bagian ini */
@media (max-width: 768px) {
    body { padding: 8px; }
    .journal-page { padding: 16px; }
    
    /* Perbaikan untuk container tombol */
    .space-x-4 { 
        display: flex;
        flex-direction: column; 
        gap: 12px; 
        align-items: stretch; /* Ubah dari center ke stretch */
        width: 100%;
    }
    
    /* Semua tombol sama ukuran di mobile */
    .space-x-4 > * { 
        margin: 0; 
        width: 100%; 
        max-width: none; /* Hapus max-width */
        min-height: 48px; /* Tinggi minimum untuk touch */
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: 500;
    }
    
    /* Specific button styling */
    .space-x-4 button {
        padding: 12px 16px;
        border-radius: 8px;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    /* Hover effects untuk mobile (touch) */
    .space-x-4 button:active {
        transform: scale(0.98);
        box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    
    /* Disabled button state */
    .space-x-4 button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }
    
    /* Loading spinner dalam tombol */
    .space-x-4 button .spinner {
        margin-left: 8px;
        margin-right: 0;
    }
    
    /* Container untuk tombol */
    .flex.justify-center.space-x-4.mb-6.no-print {
        padding: 0 16px;
        margin-bottom: 24px;
    }
    
    /* Responsive lainnya */
    .habit-row { 
        flex-direction: column; 
        align-items: flex-start; 
        padding: 12px; 
        gap: 8px;
    }
    .habit-row .flex-1 { width: 100%; }
    .habit-row .text-right { 
        width: 100%; 
        text-align: left; 
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
    }
    .habit-detail, .habit-duration, .habit-time {
        min-width: 80px;
        padding: 4px 8px;
    }
    .date-header .flex {
        flex-direction: column;
        gap: 12px;
    }
    .date-header button {
        order: 3;
        width: 100%;
        justify-content: center;
    }
    .grid { gap: 12px; }
    .grid.md\\:grid-cols-2 { grid-template-columns: 1fr; }
    h1 { font-size: 1.875rem; }
    h2 { font-size: 1.25rem; }
    h3 { font-size: 1.125rem; }
}

/* Untuk layar sangat kecil */
@media (max-width: 480px) {
    .flex.justify-center.space-x-4.mb-6.no-print {
        padding: 0 8px;
    }
    
    .space-x-4 button {
        padding: 14px 12px;
        font-size: 13px;
        min-height: 50px;
    }
    
    .text-4xl { font-size: 1.5rem; }
    .text-2xl { font-size: 1.25rem; }
    .text-xl { font-size: 1.125rem; }
    .p-8 { padding: 12px; }
    .p-6 { padding: 12px; }
    .p-4 { padding: 8px; }
}

/* Perbaikan tambahan untuk konsistensi tombol */
@media (max-width: 768px) {
    /* Pastikan semua tombol memiliki style yang konsisten */
    .bg-green-500, .bg-purple-500, .bg-blue-500, .bg-red-500 {
        width: 100% !important;
        margin: 0 !important;
        max-width: none !important;
    }
    
    /* Spacing yang konsisten */
    .space-x-4 > button:not(:last-child) {
        margin-bottom: 0;
    }
}
        /* Loading spinner */
        .spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
            margin-top: 10px;
            display: none;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #f5c6cb;
            margin-top: 10px;
            display: none;
        }
        /* Notifikasi yang lebih menarik */
.success-message {
    background: linear-gradient(135deg, #d4edda, #c3e6cb);
    color: #155724;
    padding: 16px 20px;
    border-radius: 12px;
    border: 2px solid #28a745;
    margin: 16px 0;
    display: none;
    font-weight: 500;
    font-size: 16px;
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.2);
    animation: slideIn 0.5s ease-out;
    position: relative;
    overflow: hidden;
}

.success-message::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shine 2s ease-in-out;
}

.error-message {
    background: linear-gradient(135deg, #f8d7da, #f5c6cb);
    color: #721c24;
    padding: 16px 20px;
    border-radius: 12px;
    border: 2px solid #dc3545;
    margin: 16px 0;
    display: none;
    font-weight: 500;
    font-size: 16px;
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.2);
    animation: slideIn 0.5s ease-out;
}

/* Animasi slide in */
@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Animasi shine effect */
@keyframes shine {
    0% { left: -100%; }
    100% { left: 100%; }
}

/* Pulse animation untuk tombol sukses */
.btn-success-pulse {
    animation: successPulse 0.6s ease-in-out;
}

@keyframes successPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); background-color: #28a745; }
    100% { transform: scale(1); }
}

/* Notification toast style (alternatif) */
.toast-notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: #28a745;
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 10000;
    font-weight: 500;
    animation: toastSlideIn 0.3s ease-out;
}

.toast-notification.error {
    background: #dc3545;
}

@keyframes toastSlideIn {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-purple-100 min-h-screen p-4">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-4xl font-bold text-blue-800 mb-2">JURNAL HARIAN</h1>
            <h2 class="text-2xl font-semibold text-blue-600">7 Kebiasaan Anak Indonesia Hebat</h2>
            <h3 class="text-xl font-semibold text-blue-900">SDN CAKUNG BARAT 01</h3>
        </div>

        <!-- Status Messages -->
        <div id="successMessage" class="success-message">
            ‚úÖ Data berhasil disimpan ke Google Spreadsheet!
        </div>
        <div id="errorMessage" class="error-message">
            ‚ùå <span id="errorText">Terjadi kesalahan saat menyimpan data.</span>
        </div>

        <!-- Journal Page -->
        <div class="journal-page rounded-2xl p-8 mb-6">
            <!-- Date Section -->
            <div class="date-header text-white rounded-xl p-4 mb-6 text-center">
                <div class="flex justify-between items-center">
                    <button onclick="changeDate(-1)" class="no-print bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full px-4 py-2 transition-colors">
                        ‚Üê Kemarin
                    </button>
                    <div>
                        <h3 class="text-2xl font-bold" id="currentDate"></h3>
                        <p class="text-blue-100" id="currentDay"></p>
                    </div>
                    <button onclick="changeDate(1)" class="no-print bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full px-4 py-2 transition-colors">
                        Besok ‚Üí
                    </button>
                </div>
            </div>

            <!-- Personal Info -->
            <div class="grid md:grid-cols-2 gap-4 mb-6">
                <div class="bg-white bg-opacity-60 rounded-lg p-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama:</label>
                    <input type="text" id="studentName" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent" placeholder="Tulis namamu di sini..." required>
                </div>
                <div class="bg-white bg-opacity-60 rounded-lg p-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kelas:</label>
                    <input type="text" id="studentClass" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent" placeholder="Contoh: 3A" required>
                </div>
            </div>

            <!-- 7 Habits Checklist -->
            <div class="bg-white bg-opacity-60 rounded-lg p-6 mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">‚úÖ CHECKLIST 7 KEBIASAAN HEBAT</h3>
                
                <div class="space-y-4">
                    <!-- Habit 1 -->
                    <div class="habit-row flex items-center p-3 rounded-lg" data-habit="0">
                        <div class="checkbox-custom mr-4" onclick="toggleHabit(0)"></div>
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üôè</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">1. Berdoa & Beribadah</h4>
                                    <p class="text-sm text-gray-600">Memulai dan mengakhiri hari dengan berdoa</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-500">Waktu:</span>
                            <input type="time" class="habit-time ml-2 p-1 text-xs border rounded" data-habit="0">
                        </div>
                    </div>

                    <!-- Habit 2 -->
                    <div class="habit-row flex items-center p-3 rounded-lg" data-habit="1">
                        <div class="checkbox-custom mr-4" onclick="toggleHabit(1)"></div>
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üìö</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">2. Membaca Buku</h4>
                                    <p class="text-sm text-gray-600">Membaca minimal 15 menit setiap hari</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-500">Durasi:</span>
                            <input type="number" min="0" max="180" class="habit-duration ml-2 p-1 text-xs border rounded w-16" placeholder="15" data-habit="1">
                            <span class="text-xs text-gray-500">menit</span>
                        </div>
                    </div>

                    <!-- Habit 3 -->
                    <div class="habit-row flex items-center p-3 rounded-lg" data-habit="2">
                        <div class="checkbox-custom mr-4" onclick="toggleHabit(2)"></div>
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üèÉ</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">3. Olahraga & Bergerak Aktif</h4>
                                    <p class="text-sm text-gray-600">Berolahraga atau bergerak aktif minimal 30 menit</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-500">Jenis:</span>
                            <input type="text" class="habit-detail ml-2 p-1 text-xs border rounded w-20" placeholder="Lari" data-habit="2">
                        </div>
                    </div>

                    <!-- Habit 4 -->
                    <div class="habit-row flex items-center p-3 rounded-lg" data-habit="3">
                        <div class="checkbox-custom mr-4" onclick="toggleHabit(3)"></div>
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">ü§ù</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">4. Membantu Orang Tua</h4>
                                    <p class="text-sm text-gray-600">Membantu pekerjaan rumah dan menghormati orang tua</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-500">Bantuan:</span>
                            <input type="text" class="habit-detail ml-2 p-1 text-xs border rounded w-24" placeholder="Cuci piring" data-habit="3">
                        </div>
                    </div>

                    <!-- Habit 5 -->
                    <div class="habit-row flex items-center p-3 rounded-lg" data-habit="4">
                        <div class="checkbox-custom mr-4" onclick="toggleHabit(4)"></div>
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üéØ</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">5. Belajar dengan Fokus</h4>
                                    <p class="text-sm text-gray-600">Mengerjakan tugas sekolah dengan konsentrasi penuh</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-500">Mata Pelajaran:</span>
                            <input type="text" class="habit-detail ml-2 p-1 text-xs border rounded w-20" placeholder="Matematika" data-habit="4">
                        </div>
                    </div>

                    <!-- Habit 6 -->
                    <div class="habit-row flex items-center p-3 rounded-lg" data-habit="5">
                        <div class="checkbox-custom mr-4" onclick="toggleHabit(5)"></div>
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üëç</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">6. Berbuat Baik</h4>
                                    <p class="text-sm text-gray-600">Melakukan kebaikan kepada sesama dan lingkungan</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-500">Kebaikan:</span>
                            <input type="text" class="habit-detail ml-2 p-1 text-xs border rounded w-24" placeholder="Membantu teman" data-habit="5">
                        </div>
                    </div>

                    <!-- Habit 7 -->
                    <div class="habit-row flex items-center p-3 rounded-lg" data-habit="6">
                        <div class="checkbox-custom mr-4" onclick="toggleHabit(6)"></div>
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üåü</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">7. Bersyukur</h4>
                                    <p class="text-sm text-gray-600">Menulis hal-hal yang disyukuri hari ini</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-green-600 font-medium" id="gratitudeCount">0/3</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gratitude Section -->
            <div class="bg-white bg-opacity-60 rounded-lg p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                    <span class="text-2xl mr-2">üôè</span>
                    Hari ini saya bersyukur karena...
                </h3>
                <div class="space-y-3">
                    <div class="flex items-start">
                        <span class="text-blue-600 font-bold mr-3 mt-1">1.</span>
                        <textarea id="gratitude1" rows="2" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent resize-none" placeholder="Tulis hal pertama yang kamu syukuri..."></textarea>
                    </div>
                    <div class="flex items-start">
                        <span class="text-blue-600 font-bold mr-3 mt-1">2.</span>
                        <textarea id="gratitude2" rows="2" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent resize-none" placeholder="Tulis hal kedua yang kamu syukuri..."></textarea>
                    </div>
                    <div class="flex items-start">
                        <span class="text-blue-600 font-bold mr-3 mt-1">3.</span>
                        <textarea id="gratitude3" rows="2" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent resize-none" placeholder="Tulis hal ketiga yang kamu syukuri..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Daily Reflection -->
            <div class="bg-white bg-opacity-60 rounded-lg p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                    <span class="text-2xl mr-2">üí≠</span>
                    Refleksi Hari Ini
                </h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Pencapaian terbaik hari ini:</label>
                        <textarea id="achievement" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent resize-none" placeholder="Apa yang membuatmu bangga hari ini?"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Yang ingin diperbaiki besok:</label>
                        <textarea id="improvement" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent resize-none" placeholder="Apa yang bisa kamu lakukan lebih baik?"></textarea>
                    </div>
                </div>
            </div>

            <!-- Mood & Energy -->
            <div class="bg-white bg-opacity-60 rounded-lg p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4">üìä Suasana Hati & Energi</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-3">Suasana Hati:</label>
                        <div class="flex justify-between">
                            <button onclick="setMood(1)" class="mood-btn text-3xl p-2 rounded-lg hover:bg-gray-100 transition-colors" data-mood="1">üò¢</button>
                            <button onclick="setMood(2)" class="mood-btn text-3xl p-2 rounded-lg hover:bg-gray-100 transition-colors" data-mood="2">üòê</button>
                            <button onclick="setMood(3)" class="mood-btn text-3xl p-2 rounded-lg hover:bg-gray-100 transition-colors" data-mood="3">üôÇ</button>
                            <button onclick="setMood(4)" class="mood-btn text-3xl p-2 rounded-lg hover:bg-gray-100 transition-colors" data-mood="4">üòä</button>
                            <button onclick="setMood(5)" class="mood-btn text-3xl p-2 rounded-lg hover:bg-gray-100 transition-colors" data-mood="5">üòÑ</button>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-3">Level Energi:</label>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-600">Rendah</span>
                            <input type="range" id="energyLevel" min="1" max="10" value="5" class="flex-1">
                            <span class="text-sm text-gray-600">Tinggi</span>
                            <span id="energyValue" class="text-sm font-bold text-blue-600 ml-2">5</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Summary -->
            <div class="bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-lg p-6 text-center">
                <h3 class="text-xl font-bold mb-2">üéØ Progress Hari Ini</h3>
                <div class="text-4xl font-bold mb-2" id="progressPercentage">0%</div>
                <div class="text-lg" id="progressMessage">Ayo semangat menyelesaikan kebiasaan hebatmu!</div>
                <div class="mt-4 bg-white bg-opacity-20 rounded-full h-4">
                    <div id="progressBar" class="bg-white rounded-full h-4 transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-center space-x-4 mb-6 no-print">
            <button onclick="saveJournal()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                üíæ Simpan Jurnal
            </button>
            <button onclick="saveToSpreadsheet()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-medium transition-colors" id="spreadsheetBtn">
                üìä Simpan ke Spreadsheet
            </button>
            <button onclick="printJournal()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                üñ®Ô∏è Cetak Jurnal
            </button>
            <button onclick="resetJournal()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                üîÑ Reset
            </button>
        </div>
    </div>

    <script>
        // Google Apps Script URL - sudah dikonfigurasi
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx2jBkl2zv4LWepLQ4R5doMTvQZX5RVeMG39On_T5DZvgFBFRgijw5V2rewXHvofISBQg/exec';

        let currentDate = new Date();
        let habits = Array(7).fill(false);
        let selectedMood = 0;
        let journalData = {};

        // Initialize
        function init() {
            updateDateDisplay();
            loadJournalData();
            setupEventListeners();
            updateProgress();
        }

        // Update date display
        function updateDateDisplay() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = currentDate.toLocaleDateString('id-ID', options);
            document.getElementById('currentDay').textContent = `Hari ke-${Math.ceil((currentDate - new Date(currentDate.getFullYear(), 0, 1)) / (1000 * 60 * 60 * 24))} tahun ${currentDate.getFullYear()}`;
        }

        // Change date
        function changeDate(days) {
            saveCurrentJournal();
            currentDate.setDate(currentDate.getDate() + days);
            updateDateDisplay();
            loadJournalData();
        }

        // Toggle habit
        function toggleHabit(index) {
            habits[index] = !habits[index];
            const checkbox = document.querySelector(`[data-habit="${index}"] .checkbox-custom`);
            checkbox.classList.toggle('checked', habits[index]);
            updateProgress();
            updateGratitudeCount();
        }

        // Set mood
        function setMood(mood) {
            selectedMood = mood;
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.classList.remove('bg-yellow-200');
            });
            document.querySelector(`[data-mood="${mood}"]`).classList.add('bg-yellow-200');
        }

        // Update progress
        function updateProgress() {
            const completed = habits.filter(h => h).length;
            const percentage = Math.round((completed / habits.length) * 100);
            
            document.getElementById('progressPercentage').textContent = percentage + '%';
            document.getElementById('progressBar').style.width = percentage + '%';
            
            let message = '';
            if (percentage === 100) {
                message = 'üéâ Luar biasa! Kamu menyelesaikan semua kebiasaan hebat!';
            } else if (percentage >= 70) {
                message = 'üëè Hebat! Kamu hampir menyelesaikan semuanya!';
            } else if (percentage >= 40) {
                message = 'üí™ Bagus! Terus semangat menyelesaikan yang lain!';
            } else {
                message = 'üåü Ayo semangat menyelesaikan kebiasaan hebatmu!';
            }
            
            document.getElementById('progressMessage').textContent = message;
        }

        // Update gratitude count
        function updateGratitudeCount() {
            const gratitude1 = document.getElementById('gratitude1').value.trim();
            const gratitude2 = document.getElementById('gratitude2').value.trim();
            const gratitude3 = document.getElementById('gratitude3').value.trim();
            
            let count = 0;
            if (gratitude1) count++;
            if (gratitude2) count++;
            if (gratitude3) count++;
            
            document.getElementById('gratitudeCount').textContent = `${count}/3`;
            
            // Auto-check gratitude habit if all 3 are filled
            if (count === 3 && !habits[6]) {
                toggleHabit(6);
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Energy level slider
            document.getElementById('energyLevel').addEventListener('input', function() {
                document.getElementById('energyValue').textContent = this.value;
            });

            // Gratitude text areas
            ['gratitude1', 'gratitude2', 'gratitude3'].forEach(id => {
                document.getElementById(id).addEventListener('input', updateGratitudeCount);
            });

            // Auto-save on input changes
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('change', saveCurrentJournal);
            });
        }

        // Save current journal to memory storage
        function saveCurrentJournal() {
            const dateKey = currentDate.toDateString();
            journalData[dateKey] = {
                habits: [...habits],
                mood: selectedMood,
                energy: document.getElementById('energyLevel').value,
                name: document.getElementById('studentName').value,
                class: document.getElementById('studentClass').value,
                gratitude1: document.getElementById('gratitude1').value,
                gratitude2: document.getElementById('gratitude2').value,
                gratitude3: document.getElementById('gratitude3').value,
                achievement: document.getElementById('achievement').value,
                improvement: document.getElementById('improvement').value,
                habitDetails: Array.from(document.querySelectorAll('.habit-time, .habit-duration, .habit-detail')).map(el => el.value)
            };
            
            // Store in memory for Claude environment
            window.journalStorage = journalData;
        }

        // Load journal data
        function loadJournalData() {
            // Load from window storage
            if (window.journalStorage) {
                journalData = window.journalStorage;
            }

            const dateKey = currentDate.toDateString();
            const data = journalData[dateKey];

            if (data) {
                habits = [...data.habits];
                selectedMood = data.mood || 0;
                
                // Update UI
                habits.forEach((completed, index) => {
                    const checkbox = document.querySelector(`[data-habit="${index}"] .checkbox-custom`);
                    checkbox.classList.toggle('checked', completed);
                });

                if (selectedMood > 0) {
                    setMood(selectedMood);
                }

                // Restore form values
                document.getElementById('energyLevel').value = data.energy || 5;
                document.getElementById('energyValue').textContent = data.energy || 5;
                document.getElementById('studentName').value = data.name || '';
                document.getElementById('studentClass').value = data.class || '';
                document.getElementById('gratitude1').value = data.gratitude1 || '';
                document.getElementById('gratitude2').value = data.gratitude2 || '';
                document.getElementById('gratitude3').value = data.gratitude3 || '';
                document.getElementById('achievement').value = data.achievement || '';
                document.getElementById('improvement').value = data.improvement || '';

                if (data.habitDetails) {
                    const detailInputs = document.querySelectorAll('.habit-time, .habit-duration, .habit-detail');
                    detailInputs.forEach((input, index) => {
                        if (data.habitDetails[index]) {
                            input.value = data.habitDetails[index];
                        }
                    });
                }
            } else {
                // Reset for new date
                habits = Array(7).fill(false);
                selectedMood = 0;
                document.querySelectorAll('.checkbox-custom').forEach(cb => cb.classList.remove('checked'));
                document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('bg-yellow-200'));
                document.getElementById('energyLevel').value = 5;
                document.getElementById('energyValue').textContent = 5;
            }

            updateProgress();
            updateGratitudeCount();
        }

        // Show message
        function showMessage(type, text) {
            hideMessages();
            const messageElement = document.getElementById(type === 'success' ? 'successMessage' : 'errorMessage');
            if (type === 'error') {
                document.getElementById('errorText').textContent = text;
            }
            messageElement.style.display = 'block';
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 5000);
        }

        // Hide all messages
        function hideMessages() {
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
        }

        // Validate form data
        function validateForm() {
            const name = document.getElementById('studentName').value.trim();
            const studentClass = document.getElementById('studentClass').value.trim();
            
            if (!name) {
                showMessage('error', 'Nama harus diisi!');
                document.getElementById('studentName').focus();
                return false;
            }
            
            if (!studentClass) {
                showMessage('error', 'Kelas harus diisi!');
                document.getElementById('studentClass').focus();
                return false;
            }
            
            return true;
        }

// Save to Google Spreadsheet with better notification
async function saveToSpreadsheet() {
    if (!validateForm()) {
        return;
    }

    const btn = document.getElementById('spreadsheetBtn');
    const originalText = btn.innerHTML;
    
    // Show loading state
    btn.innerHTML = '‚è≥ Menyimpan... <div class="spinner"></div>';
    btn.disabled = true;
    hideMessages();

    try {
        // Prepare data for spreadsheet
        const data = {
            date: currentDate.toLocaleDateString('id-ID'),
            name: document.getElementById('studentName').value.trim(),
            class: document.getElementById('studentClass').value.trim(),
            habits: habits,
            mood: getMoodText(selectedMood),
            energy: parseInt(document.getElementById('energyLevel').value),
            gratitude1: document.getElementById('gratitude1').value.trim(),
            gratitude2: document.getElementById('gratitude2').value.trim(),
            gratitude3: document.getElementById('gratitude3').value.trim(),
            achievement: document.getElementById('achievement').value.trim(),
            improvement: document.getElementById('improvement').value.trim(),
            habitDetails: Array.from(document.querySelectorAll('.habit-time, .habit-duration, .habit-detail')).map(el => el.value.trim())
        };

        console.log('Sending data to Google Apps Script:', data);

        // Send to Google Apps Script
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });

        // Karena no-cors, kita tidak bisa membaca response
        // Jadi kita asumsikan berhasil jika tidak ada error
        console.log('Request sent successfully');
        
        // Tampilkan notifikasi sukses
        showSuccessNotification();
        saveCurrentJournal(); // Also save locally
        
        // Opsional: Bersihkan form atau lakukan aksi lain
        // resetFormAfterSave(); // Uncomment jika ingin reset form setelah simpan

    } catch (error) {
        console.error('Error sending data:', error);
        showErrorNotification('Gagal menyimpan ke Google Spreadsheet. Periksa koneksi internet Anda dan coba lagi.');
    } finally {
        // Reset button
        btn.innerHTML = originalText;
        btn.disabled = false;
    }
}

// Fungsi untuk menampilkan notifikasi sukses
function showSuccessNotification() {
    // Hapus notifikasi yang ada
    hideMessages();
    
    // Tampilkan pesan sukses
    const successMsg = document.getElementById('successMessage');
    successMsg.innerHTML = '‚úÖ Data berhasil disimpan ke Google Spreadsheet!';
    successMsg.style.display = 'block';
    
    // Scroll ke atas untuk melihat notifikasi
    document.getElementById('successMessage').scrollIntoView({ 
        behavior: 'smooth', 
        block: 'nearest' 
    });
    
    // Auto hide setelah 4 detik
    setTimeout(() => {
        successMsg.style.display = 'none';
    }, 4000);
    
    // Tambahkan efek konfeti jika mau (opsional)
    showConfetti();
}

// Fungsi untuk menampilkan notifikasi error
function showErrorNotification(message) {
    hideMessages();
    
    const errorMsg = document.getElementById('errorMessage');
    document.getElementById('errorText').textContent = message;
    errorMsg.style.display = 'block';
    
    // Scroll ke notifikasi
    errorMsg.scrollIntoView({ 
        behavior: 'smooth', 
        block: 'nearest' 
    });
    
    // Auto hide setelah 6 detik
    setTimeout(() => {
        errorMsg.style.display = 'none';
    }, 6000);
}

// Fungsi konfeti sederhana (opsional)
function showConfetti() {
    // Buat efek konfeti sederhana
    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
    
    for (let i = 0; i < 50; i++) {
        setTimeout(() => {
            createConfetti(colors[Math.floor(Math.random() * colors.length)]);
        }, i * 10);
    }
}

function createConfetti(color) {
    const confetti = document.createElement('div');
    confetti.style.position = 'fixed';
    confetti.style.width = '10px';
    confetti.style.height = '10px';
    confetti.style.backgroundColor = color;
    confetti.style.left = Math.random() * 100 + '%';
    confetti.style.top = '-10px';
    confetti.style.zIndex = '9999';
    confetti.style.pointerEvents = 'none';
    confetti.style.borderRadius = '50%';
    
    document.body.appendChild(confetti);
    
    let pos = -10;
    const animation = setInterval(() => {
        pos += 3;
        confetti.style.top = pos + 'px';
        confetti.style.transform = `rotate(${pos * 2}deg)`;
        
        if (pos > window.innerHeight) {
            clearInterval(animation);
            document.body.removeChild(confetti);
        }
    }, 20);
}

// Fungsi untuk reset form setelah simpan (opsional)
function resetFormAfterSave() {
    if (confirm('Data telah disimpan! Apakah Anda ingin mengosongkan form untuk entri baru?')) {
        resetJournal();
    }
}

        // Get mood text
        function getMoodText(mood) {
            const moodTexts = {
                1: 'Sedih',
                2: 'Biasa',
                3: 'Senang',
                4: 'Gembira',
                5: 'Sangat Gembira'
            };
            return moodTexts[mood] || 'Belum dipilih';
        }

        // Save journal locally
        function saveJournal() {
            if (!validateForm()) {
                return;
            }
            
            saveCurrentJournal();
            showMessage('success', 'Jurnal berhasil disimpan secara lokal!');
        }

        // Print journal
        function printJournal() {
            saveCurrentJournal();
            window.print();
        }

        // Reset journal
        function resetJournal() {
            if (confirm('Yakin ingin mereset jurnal hari ini? Semua data akan hilang!')) {
                const dateKey = currentDate.toDateString();
                delete journalData[dateKey];
                window.journalStorage = journalData;
                loadJournalData();
                
                // Clear all inputs
                document.querySelectorAll('input[type="text"], input[type="number"], input[type="time"], textarea').forEach(input => {
                    input.value = '';
                });
                
                // Reset mood
                document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('bg-yellow-200'));
                selectedMood = 0;
                
                showMessage('success', 'Jurnal berhasil direset!');
            }
        }
// Fungsi untuk membuat toast notification (alternatif)
function showToast(message, type = 'success', duration = 4000) {
    // Hapus toast yang ada
    const existingToast = document.querySelector('.toast-notification');
    if (existingToast) {
        existingToast.remove();
    }
    
    // Buat toast baru
    const toast = document.createElement('div');
    toast.className = `toast-notification ${type}`;
    toast.innerHTML = `
        <div style="display: flex; align-items: center; gap: 8px;">
            <span>${type === 'success' ? '‚úÖ' : '‚ùå'}</span>
            <span>${message}</span>
            <button onclick="this.parentElement.parentElement.remove()" 
                    style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; margin-left: auto;">
                √ó
            </button>
        </div>
    `;
    
    document.body.appendChild(toast);
    
    // Auto remove setelah duration
    setTimeout(() => {
        if (toast && toast.parentElement) {
            toast.style.animation = 'toastSlideIn 0.3s ease-out reverse';
            setTimeout(() => toast.remove(), 300);
        }
    }, duration);
}

// Gunakan toast notification dalam saveToSpreadsheet
function showSuccessNotificationToast() {
    showToast('Data berhasil disimpan ke Google Spreadsheet!', 'success', 4000);
    
    // Tambahkan efek pada tombol
    const btn = document.getElementById('spreadsheetBtn');
    btn.classList.add('btn-success-pulse');
    setTimeout(() => btn.classList.remove('btn-success-pulse'), 600);
}
        // Initialize app
        init();
    </script>
</body>
</html>




